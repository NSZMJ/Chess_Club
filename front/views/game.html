<html>
  <head>
    {{> head}}
  </head>
  <body>
    <style>
      html, body {
        height: 100%;
        margin: 0;
        padding: 0;
      }
      body {
        background: #1c2526;
        color: #e0f7fa;
        transition: background 0.3s, color 0.3s;
      }
      body.light-mode {
        background: #f7f7f7;
        color: #222;
      }
      .center-container {
        background: #232e30;
        border-radius: 18px;
        padding: 2rem 2.5rem;
        box-shadow: 0 2px 24px 0 rgba(28, 37, 38, 0.18);
        transition: background 0.3s, color 0.3s;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        min-height: 100vh;
        max-width: 95vw;
        margin: 0 auto;
      }
      body.light-mode .center-container {
        background: #fff;
        color: #222;
        box-shadow: 0 2px 24px 0 rgba(28, 37, 38, 0.08);
      }
      #myBoard {
        width: 700px;
        max-width: 90vw;
        min-width: 250px;
        aspect-ratio: 1 / 1;
      }
      @media (max-width: 900px) {
        .center-container {
          padding: 1rem 0.5rem;
        }
        #myBoard {
          width: 90vw;
          min-width: 180px;
        }
      }
      @media (max-width: 600px) {
        .center-container {
          padding: 0.5rem 0.2rem;
          border-radius: 8px;
        }
        #myBoard {
          width: 98vw;
          min-width: 120px;
        }
      }
      @media (max-width: 400px) {
        #myBoard {
          width: 99vw;
          min-width: 80px;
        }
      }
    </style>
    <div class="center-container">
      <button id="theme-toggle" aria-label="Toggle dark mode" style="margin-bottom: 1rem; background: none; border: none; cursor: pointer; width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
        <span id="theme-toggle-icon">
          <!-- Moon SVG for dark mode (default) -->
          <svg id="moon-icon" width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21.5 18.5C19.5 19.5 17 20 14.5 20C9.25329 20 5 15.7467 5 10.5C5 8 5.5 5.5 6.5 3.5C3.5 5.5 1.5 9 1.5 13C1.5 19.0228 6.47715 24 12.5 24C16.5 24 20 22 21.5 18.5Z" fill="#fff" stroke="#fff" stroke-width="2"/>
          </svg>
          <!-- Sun SVG for light mode (hidden by default) -->
          <svg id="sun-icon" width="28" height="28" viewBox="0 0 28 28" fill="none" style="display: none" xmlns="http://www.w3.org/2000/svg">
            <circle cx="14" cy="14" r="6" fill="#222" stroke="#222" stroke-width="2"/>
            <g stroke="#222" stroke-width="2">
              <line x1="14" y1="2" x2="14" y2="6" />
              <line x1="14" y1="22" x2="14" y2="26" />
              <line x1="2" y1="14" x2="6" y2="14" />
              <line x1="22" y1="14" x2="26" y2="14" />
              <line x1="5.05" y1="5.05" x2="7.88" y2="7.88" />
              <line x1="20.12" y1="20.12" x2="22.95" y2="22.95" />
              <line x1="5.05" y1="22.95" x2="7.88" y2="20.12" />
              <line x1="20.12" y1="7.88" x2="22.95" y2="5.05" />
            </g>
          </svg>
        </span>
      </button>
      <div id="myBoard" style="width: 700px"></div>
      <label>Status:</label>
      <div id="status"></div>
      <label>PGN:</label>
      <div id="pgn"></div>
    </div>
    <script>
      let playerColor = "{{color}}";
      console.log("Playing as " + playerColor);
    </script>
    <script src="/public/js/index.js"></script>
    <script>
      const toggleBtn = document.getElementById("theme-toggle");
      const body = document.body;
      const moonIcon = document.getElementById("moon-icon");
      const sunIcon = document.getElementById("sun-icon");
      // On load, set theme from localStorage
      if (localStorage.getItem("theme") === "light") {
        body.classList.add("light-mode");
        sunIcon.style.display = "";
        moonIcon.style.display = "none";
      } else {
        sunIcon.style.display = "none";
        moonIcon.style.display = "";
      }
      toggleBtn.addEventListener("click", () => {
        body.classList.toggle("light-mode");
        const isLight = body.classList.contains("light-mode");
        if (isLight) {
          localStorage.setItem("theme", "light");
          sunIcon.style.display = "";
          moonIcon.style.display = "none";
        } else {
          localStorage.setItem("theme", "dark");
          sunIcon.style.display = "none";
          moonIcon.style.display = "";
        }
      });
    </script>
  </body>
</html>
